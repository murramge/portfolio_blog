---
title: 'Javascript와 React의 렌더링 '
date: '2024-04-04'
lastmod: '2024-04-04'
tags: ['frontend', 'react', 'rendering', 'javascript', 'DOM']
draft: false
summary: 'javascript와 react의 렌더링 시 차이점에 대해 작성한 글 입니다.'
---

## JAVAScript와 DOM

    javascript로 DOM을 직접적으로 수정해서 업데이트를 구현할 때, 주의할 점이 있다.
    레이아웃을 다시 하는 것과, 페인트를 다시하는 것 즉 리플로우, 리페인트는 연산이 좀 비싸다. 비싼 과정이라 시간이 오래걸린다.
    그래서, Javascript로 DOM을 조작할 때는 DOM을 최소화 하는 것이 중요하다. 예를 들어서 요소의 300개의 업데이트가 필요하다 했을 때는,
    각각 리플로우와 리페인트가 300번 돌아가는 심각한 성능저하를 일으킨다. 렉이 걸린다던가, 웹 브라우저가 죽는다.

    ```html
    <script>
        function onClick() {
            const $ul = document.getElementById('ul');
            for (let i = 0; i < 3000; i++) {
                $ul.innerHTML += `<li>${i}</li>
            }
        }
    </script>
    <body>
        <button onClick="onClick()">리스트 추가하기</button>
        <ul id="ul"><ul>
    </body>
    ```

    코드를 확인하면, 버튼이 하나 있고, ul 엘리먼트가 하나 있는데 리스트 추가하기를 클릭하면, onClick 함수에서는 ul태그를 가져오고 3000번의 반복동안 ul의 innerHTML을 수정하면서 추가하게 된다.

    자바스크립트를 이렇게 작성하는 것은 굉장히 좋지 않은 방식이다. 3000번동안 계속 innerHTML을 수정한다는 것은, 곧 DOM을 3000번 수정시키는 코드라는 것이다.
    이어서 연산이 비쌌던 리플로우와 리페인트도 3000번이 발생하게 된다. 그래서 성능이 굉장히 나쁘다고 표현할 수 있다. 4.5초 걸린다.

    ```html
    <script>
        function onClick() {
            const $ul = document.getElementById('ul');
            let list = ""

            for(let i = 0; i < 3000; i++) {
                list += `<li>${i}</li>`
            }
            $ul.innerHTML = list;
        }
    </script>
    ```
    
    list를 선언하고, list += 로 문자열 형태로 3000번을 저장한다.
    그리고 반복문을 끝내고 innerHTML을 한 번만 추가해주었다. 고로, 돔을 딱 한 번만 수정하도록 바꾸었다. 성능이 훨씬 개선된다. 0.2초 걸린다.

    ✨ Javascript를 이용해서 DOM을 직접 조작해서 업데이트를 구현해야 될 때에는,

    다양한 업데이트가 있다 -> 동시에 발생한 업데이트를 모은다 -> 다 모았다면 한 번에 수정 -> DOM
    
    이로 인해 발생하는 리플로우 리페인트를 최소화해야한다. 하지만, 서비스의 규모가 커질수록 점점 힘들어진다.
    순수한 자바스크립트의 힘만 가지고는 복잡하고 규모가 커질수록 힘들어진다. 
